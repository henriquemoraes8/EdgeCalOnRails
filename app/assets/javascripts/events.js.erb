$(document).on('ready page:load', function(){
  $('#calendar').fullCalendar({
	  
	editable: false,
	header: {
      left: 'prev today next',
      center: 'title',
      right: 'month,agendaWeek,agendaDay'
	},
	height: 500,
	defaultView: 'month',
	theme: true,
	buttonIcons: {
		prev: 'left-single-arrow',
     	next: 'right-single-arrow'
	},
	  
	eventSources: [
		
		{
			url: '/events',
		},
		
		{
			url: '/events/busy_events.json',
			color: 'red'
		},
		
	],
	
	windowResize: function(view) {
	      if ($(window).width() < 514){
	        $('#calendar').fullCalendar( 'changeView', 'agendaDay' );
	      } else {
	        $('#calendar').fullCalendar( 'changeView', 'agendaWeek' );
	      }
	 }
	
  })
  $('#calendar').fullCalendar('refetchEvents')
}).call(this);

