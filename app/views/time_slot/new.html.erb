<h2>New Time Slot Event</h2>

<div class="event block">
  <%= form_for('event_blocks', :url => {:controller => 'time_slot', :action => 'create'}) do |f| %>
      <div class="field">
        <%= f.label :title %><br>
        <%= f.text_field :title %>
      </div>
      <div class="field">
        <%= f.label :description %><br>
        <%= f.text_area :description %>
      </div>
      <%= f.fields_for :repetition_scheme do |r| %>
          <div class="field">
            <%= r.label 'minimum slot duration' %><br>
            <%= r.time_select :min_duration, {:include_blank => true, :minute_step => 5, :time_separator => " hours and ", :start_hour => 0, :end_hour => 2} %> minutes
          </div>
          <div class="field">
            <%= r.label 'maximum slot duration' %><br>
            <%= r.time_select :max_duration, {:include_blank => true, :minute_step => 5, :time_separator => " hours and ", :start_hour => 0, :end_hour => 2} %> minutes
          </div>
      <% end %>
	  

      <hr>

      <h3>Preference options</h3><br>
      <div class="field">
        <%= f.check_box :preference %> <%= f.label :preference %> <%= f.check_box :create_to_do %> <%= f.label :create_to_do %>
      </div>

      <hr>

<h3>Participants</h3><br>
<h4>Users</h4>
	<% @users.each do |u| %>
    	<%= check_box('user_participant',"#{u.id}") %>
    	<%= u.email %>
    	<br>
	<% end %>
	<br><br>
	<h4>Groups</h4>
	<% @groups.each do |g| %>
    	<%= check_box('group_participant',"#{g.id}") %>
   	 	<%= g.title %>
    	<br>
	<% end %>

	  <hr>

      <h3>Blocks</h3>


      <div id="time_slot_events">
      <% @events.each do |e| %>
	  	<%= render :partial => 'form_event', :locals => {:f => f, :event => e} %>
          <script type="text/javascript">

            $(document).ready(function(){
            $('#MyButton').click(function(){
              $('#time_slot_events').append("<div class='partial'><%= escape_javascript render(:partial => 'form_event', :locals => { :f => f, :event => e }) %>");
              $("#datetimepicker").datetimepicker();
              
              });
              //location.reload();
            });

          // if (localStorage.getItem("alert")===null){
          //   alert("FEFF");
          // }
          // else{
          //   alert(localStorage.getItem("alert"));
          // }
          //console.log(alert);
          //if (alert ==){
          //var alert = prompt("How many different slot blocks would you like?  Choose a number between 1 and 10", 1);
          //}

          //var num = parseInt(alert);

          //if (isNaN(num)){
            //alert = localStorage.setItem("alert", "You didn't enter a valid number.  How many different slot blocks would you like?");
            //location.reload();
          //}

          //for (i=0; i<num; i++){
              //$('#time_slot_events').append("<div class='partial'><%= escape_javascript render(:partial => 'form_event', :locals => { :f => f, :event => e }) %>");
            //}
            //location.reload();
          </script>
          <%#= render :partial => 'form_event', :locals => {:f => f, :event => e} %>
      <% end %>
      </div>
      <input type="button" value="Add Another Block" id="MyButton" class="button radius">
      <%#= f.button 'Add Event Block', id: 'add_button', class:'button radius', :action => :add_event_block, :remote => true %>


      <div class="actions">
        <%= f.submit 'Create Time Slots', class: "button radius"%>
      </div>
  <% end %>


</div>

